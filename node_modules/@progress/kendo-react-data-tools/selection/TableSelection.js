/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright Â© 2024 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
"use client";"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const z=require("react"),B=require("react-dom"),k=require("@progress/kendo-react-common"),n=require("./utils.js"),V=require("./constants.js");function p(l){const r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(l){for(const c in l)if(c!=="default"){const y=Object.getOwnPropertyDescriptor(l,c);Object.defineProperty(r,c,y.get?y:{enumerable:!0,get:()=>l[c]})}}return r.default=l,Object.freeze(r)}const t=p(z),G=p(B),J=l=>{var C;const{onRelease:r,childRef:c}=l,{enabled:y,drag:I,mode:d,cell:x}=n.getSelectionOptions(l.selectable),u=t.useRef(null),D=t.useRef(null),R=t.useRef({clientX:0,clientY:0}),[K,E]=t.useState(null),M=t.useRef(),b=t.useRef(!1),v=t.useRef(!1),q=t.useCallback(m=>{const{event:e}=m;v.current=e.originalEvent.target.hasAttribute(V.TABLE_PREVENT_SELECTION_ELEMENT),!(v.current||!u.current)&&(M.current=n.relativeContextElement(u.current.element),R.current={clientY:e.clientY,clientX:e.clientX})},[]),j=t.useCallback(m=>{const{event:e}=m,{clientX:o,clientY:s}=R.current;if(!v.current&&!(!I||d==="single")&&((Math.abs(s-e.clientY)>5||Math.abs(o-e.clientX)>5)&&(b.current=!0),b.current)){const a=n.getOffset(M.current);E({top:Math.min(s,e.clientY)-a.top,left:Math.min(o,e.clientX)-a.left,width:Math.abs(e.clientX-o),height:Math.abs(e.clientY-s)})}},[E,I,d]),F=t.useCallback(m=>{const{event:e}=m,{clientX:o,clientY:s}=R.current;if(v.current||!u.current)return;const a=u.current.element&&u.current.element.ownerDocument;if(a){if(b.current){const f=Math.min(s,e.clientY),h=Math.min(o,e.clientX),T=Math.max(s,e.clientY),g=Math.max(o,e.clientX),i=D.current;if(!i)return;i.style.visibility="hidden";const O=a.elementFromPoint(h,f),P=a.elementFromPoint(g,T);if(i.style.visibility="",!O||!P)return;const S=n.closestTagName(O,"TD"),L=n.closestTagName(S,"TR"),w=n.closestTagName(P,"TD"),A=n.closestTagName(w,"TR"),N=n.getColumnIndex(S),X=n.getRowIndex(L),Y=n.getColumnIndex(w),_=n.getRowIndex(A);N!==void 0&&X!==void 0&&Y!==void 0&&_!==void 0&&r({nativeEvent:e.originalEvent,startRowIndex:X,startColIndex:N,endRowIndex:_,endColIndex:Y,altKey:e.altKey,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,mode:d,cell:x,isDrag:!0})}else{const f=a.elementFromPoint(o,s);if(!f)return;const h=n.closestTagName(f,"TD"),T=n.closestTagName(f,"TR"),g=n.getColumnIndex(h),i=n.getRowIndex(T);h&&T&&i!==void 0&&g!==void 0&&r({nativeEvent:e.originalEvent,startRowIndex:i,startColIndex:g,endRowIndex:i,endColIndex:g,altKey:e.altKey,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,mode:d,cell:x,isDrag:!1})}E(null),b.current=!1,R.current={clientX:0,clientY:0}}},[E,d,x,r]),H=k.useDocument(D);return y?t.createElement(t.Fragment,null,t.createElement(k.Draggable,{onPress:q,onDrag:j,onRelease:F,ref:u,childRef:c},l.children),K&&G.createPortal(t.createElement("div",{ref:D,style:{...K,position:"fixed"},className:"k-marquee k-marquee-color"}),(C=H())==null?void 0:C.body)):t.cloneElement(t.Children.only(l.children),{ref:c})};exports.TableSelection=J;
